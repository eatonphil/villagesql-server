# Test HANDLER READ (Index Scan) with COMPLEX type
# Grammar: HANDLER tbl_name READ index_name FIRST/NEXT ...

--source include/villagesql/install_complex_extension.inc

CREATE TABLE t1 (id INT PRIMARY KEY, val COMPLEX);
# Insert data with zero variants interleaved (~20 rows)
INSERT INTO t1 VALUES (4, '(-0,0)'), (5, '(5.0,6.0)'), (6, '(7.0,8.0)');
INSERT INTO t1 VALUES (1, '(1.0,2.0)'), (2, '(0,0)'), (3, '(3.0,4.0)');
INSERT INTO t1 VALUES (16, '(23.0,24.0)'), (17, '(25.0,26.0)'), (18, '(27.0,28.0)');
INSERT INTO t1 VALUES (7, '(0,-0)'), (8, '(9.0,10.0)'), (9, '(-0,-0)');
INSERT INTO t1 VALUES (19, '(29.0,30.0)'), (20, '(31.0,32.0)');
INSERT INTO t1 VALUES (10, '(11.0,12.0)'), (11, '(13.0,14.0)'), (12, '(15.0,16.0)');
INSERT INTO t1 VALUES (13, '(17.0,18.0)'), (14, '(19.0,20.0)'), (15, '(21.0,22.0)');

# Test HANDLER index scan - read through multiple rows
HANDLER t1 OPEN;
HANDLER t1 READ `PRIMARY` FIRST;
HANDLER t1 READ `PRIMARY` NEXT;
HANDLER t1 READ `PRIMARY` NEXT;
HANDLER t1 READ `PRIMARY` NEXT;
HANDLER t1 READ `PRIMARY` NEXT;
HANDLER t1 READ `PRIMARY` NEXT;
HANDLER t1 READ `PRIMARY` NEXT;
HANDLER t1 READ `PRIMARY` NEXT;
HANDLER t1 READ `PRIMARY` NEXT;
HANDLER t1 READ `PRIMARY` NEXT;
HANDLER t1 READ `PRIMARY` NEXT;
HANDLER t1 READ `PRIMARY` NEXT;
HANDLER t1 READ `PRIMARY` NEXT;
HANDLER t1 CLOSE;

DROP TABLE t1;

--source include/villagesql/uninstall_complex_extension.inc
