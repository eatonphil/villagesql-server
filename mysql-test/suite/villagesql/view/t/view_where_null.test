# Test VIEW with WHERE clause using NULL checks on COMPLEX column

--source include/villagesql/install_complex_extension.inc

CREATE TABLE t1 (id INT PRIMARY KEY, val COMPLEX);
INSERT INTO t1 VALUES (1, '(1,2)'), (2, NULL), (3, '(3,4)');

# View with WHERE clause using IS NULL on COMPLEX column
CREATE VIEW v_nullcheck AS
SELECT id, val FROM t1 WHERE val IS NULL;

SELECT * FROM v_nullcheck;

# View with WHERE clause using IS NOT NULL
CREATE VIEW v_notnull AS
SELECT id, val FROM t1 WHERE val IS NOT NULL;

SELECT * FROM v_notnull ORDER BY id;

DROP VIEW v_nullcheck;
DROP VIEW v_notnull;
DROP TABLE t1;

--source include/villagesql/uninstall_complex_extension.inc
