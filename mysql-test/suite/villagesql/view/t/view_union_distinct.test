# Test VIEW with UNION on COMPLEX columns (eliminates duplicates)

--source include/villagesql/install_complex_extension.inc

CREATE TABLE t1 (val COMPLEX);
CREATE TABLE t2 (val COMPLEX);

INSERT INTO t1 VALUES ('(1,2)'), ('(3,4)'), ('(1,2)');
INSERT INTO t2 VALUES ('(1,2)'), ('(5,6)');

# View with UNION (eliminates duplicate COMPLEX values)
CREATE VIEW v_union AS
SELECT val FROM t1
UNION
SELECT val FROM t2;

# UNION should eliminate duplicate COMPLEX values
# t1 has: (1,2), (3,4), (1,2)
# t2 has: (1,2), (5,6)
# Result should have 3 unique values: (1,2), (3,4), (5,6)
SELECT COUNT(*) AS unique_values FROM v_union;

DROP VIEW v_union;
DROP TABLE t2;
DROP TABLE t1;

--source include/villagesql/uninstall_complex_extension.inc
