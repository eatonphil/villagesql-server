CREATE TABLE t1 (id INT PRIMARY KEY, val COMPLEX, amount DECIMAL(10,2));
INSERT INTO t1 VALUES
(1, '(1,2)', 100.00),
(2, '(3,4)', 200.00),
(3, '(5,6)', 150.00);
CREATE VIEW v_check AS
SELECT id, val, amount FROM t1 WHERE amount > 100
WITH CHECK OPTION;
SELECT * FROM v_check ORDER BY id;
id	val	amount
2	(3,4)	200.00
3	(5,6)	150.00
INSERT INTO v_check VALUES (4, '(7,8)', 175.00);
SELECT * FROM v_check WHERE id = 4;
id	val	amount
4	(7,8)	175.00
INSERT INTO v_check VALUES (5, '(9,10)', 50.00);
ERROR HY000: CHECK OPTION failed 'test.v_check'
SELECT COUNT(*) FROM t1 WHERE id = 5;
COUNT(*)
0
UPDATE v_check SET amount = 250.00 WHERE id = 2;
SELECT amount FROM v_check WHERE id = 2;
amount
250.00
UPDATE v_check SET amount = 75.00 WHERE id = 3;
ERROR HY000: CHECK OPTION failed 'test.v_check'
SELECT amount FROM t1 WHERE id = 3;
amount
150.00
DROP VIEW v_check;
DROP TABLE t1;
