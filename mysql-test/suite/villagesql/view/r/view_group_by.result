CREATE TABLE t1 (id INT PRIMARY KEY, val COMPLEX, amount DECIMAL(10,2));
INSERT INTO t1 VALUES
(1, '(1,2)', 100.00),
(2, '(3,4)', 200.00),
(3, '(1,2)', 150.00),
(4, '(5,6)', 175.00),
(5, '(3,4)', 225.00);
CREATE VIEW v_grouped AS
SELECT val, COUNT(*) AS count, SUM(amount) AS total
FROM t1
GROUP BY val;
SELECT * FROM v_grouped ORDER BY count DESC;
val	count	total
(1,2)	2	250.00
(3,4)	2	425.00
(5,6)	1	175.00
DROP VIEW v_grouped;
DROP TABLE t1;
