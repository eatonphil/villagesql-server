CREATE TEMPORARY TABLE t_idx (
id INT PRIMARY KEY,
val COMPLEX,
description VARCHAR(50),
INDEX idx_val(val)
);
INSERT INTO t_idx VALUES
(1, '(2,0)', 'first'),
(2, '(10,0)', 'second'),
(3, '(-1,0)', 'third'),
(4, '(2,0)', 'duplicate'),
(5, '(5.0,5.0)', 'fourth');
SHOW CREATE TABLE t_idx;
Table	Create Table
t_idx	CREATE TEMPORARY TABLE `t_idx` (
  `id` int NOT NULL,
  `val` vsql_complex.COMPLEX DEFAULT NULL,
  `description` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `idx_val` (`val`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci
SHOW INDEXES FROM t_idx;
Table	Non_unique	Key_name	Seq_in_index	Column_name	Collation	Cardinality	Sub_part	Packed	Null	Index_type	Comment	Index_comment	Visible	Expression
t_idx	0	PRIMARY	1	id	A	5	NULL	NULL		BTREE			YES	NULL
t_idx	1	idx_val	1	val	A	5	NULL	NULL	YES	BTREE			YES	NULL
SELECT * FROM t_idx WHERE val = '(2,0)' ORDER BY id;
id	val	description
1	(2,0)	first
4	(2,0)	duplicate
EXPLAIN SELECT * FROM t_idx WHERE val = '(2,0)';
id	select_type	table	partitions	type	possible_keys	key	key_len	ref	rows	filtered	Extra
1	SIMPLE	t_idx	NULL	ref	idx_val	idx_val	19	const	2	100.00	Using index condition
Warnings:
Note	1003	/* select#1 */ select `test`.`t_idx`.`id` AS `id`,`test`.`t_idx`.`val` AS `val`,`test`.`t_idx`.`description` AS `description` from `test`.`t_idx` where (`test`.`t_idx`.`val` = '(2,0)')
SELECT * FROM t_idx ORDER BY val;
id	val	description
3	(-1,0)	third
1	(2,0)	first
4	(2,0)	duplicate
5	(5,5)	fourth
2	(10,0)	second
SELECT * FROM t_idx WHERE val IN ('(2,0)', '(10,0)') ORDER BY id;
id	val	description
1	(2,0)	first
2	(10,0)	second
4	(2,0)	duplicate
DROP TABLE t_idx;
CREATE TEMPORARY TABLE t_idx2 (
id INT,
val COMPLEX
);
INSERT INTO t_idx2 VALUES (1, '(3.0,4.0)'), (2, '(1.0,2.0)');
CREATE INDEX idx_val2 ON t_idx2(val);
SHOW INDEXES FROM t_idx2;
Table	Non_unique	Key_name	Seq_in_index	Column_name	Collation	Cardinality	Sub_part	Packed	Null	Index_type	Comment	Index_comment	Visible	Expression
t_idx2	1	idx_val2	1	val	A	2	NULL	NULL	YES	BTREE			YES	NULL
SELECT * FROM t_idx2 WHERE val = '(3,4)';
id	val
DROP TABLE t_idx2;
