# Test LOAD XML ... SET ... with COMPLEX type - tag name mismatch
# Grammar: LOAD XML ... SET col = expr ...
#
# In LOAD XML, user variables must match XML tag names to receive values.
# If the variable name doesn't match any tag, it gets NULL.
# This test verifies the behavior when @v doesn't match <val>.

--source include/villagesql/install_complex_extension.inc

CREATE TABLE t1 (id INT, val COMPLEX);

--write_file $MYSQLTEST_VARDIR/tmp/complex_mismatch.xml
<rows>
  <row>
    <id>1</id>
    <val>(1.0,2.0)</val>
  </row>
</rows>
EOF

--replace_result $MYSQLTEST_VARDIR MYSQLTEST_VARDIR
# Using @v instead of @val - the XML has <val> not <v>
# So @v won't match any tag and will be NULL
--eval LOAD XML INFILE '$MYSQLTEST_VARDIR/tmp/complex_mismatch.xml' INTO TABLE t1 ROWS IDENTIFIED BY '<row>' (id, @v) SET val = @v

# val should be NULL because @v didn't match any XML tag
SELECT * FROM t1 ORDER BY id;

DROP TABLE t1;
--remove_file $MYSQLTEST_VARDIR/tmp/complex_mismatch.xml

--source include/villagesql/uninstall_complex_extension.inc
