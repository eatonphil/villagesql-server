# Test SELECT ... WHERE with COMPLEX type
# Grammar: SELECT ... WHERE ...
# Tests all comparison operators with comprehensive edge cases

--source include/villagesql/install_complex_extension.inc

CREATE TABLE t1 (id INT PRIMARY KEY, val COMPLEX);
INSERT INTO t1 VALUES
  (1, '(0.0,0.0)'),           # Zero
  (2, '(1.0,2.0)'),           # Regular positive
  (3, '(3.0,4.0)'),           # Medium positive
  (4, '(-1.0,-2.0)'),         # Negative both parts
  (5, '(-5.0,3.0)'),          # Negative real, positive imaginary
  (6, '(2.0,-7.0)'),          # Positive real, negative imaginary
  (7, '(3.0,1.0)'),           # Same real as id=3, different imaginary
  (8, '(3.0,9.0)'),           # Same real as id=3, different imaginary
  (9, '(1.5e100,2.3e100)'),   # Very large positive
  (10, '(-1.5e100,-2.3e100)'), # Very large negative
  (11, '(4.22e-10,3.14e-15)'), # Very small positive
  (12, '(-1.17e-9,-8.88e-12)'); # Small negative with neg exponent

# Test equality
SELECT id FROM t1 WHERE val = '(3.0,4.0)';
SELECT id FROM t1 WHERE val = '(0.0,0.0)';
SELECT id FROM t1 WHERE val = '(-1.0,-2.0)';

# Test inequality
SELECT id FROM t1 WHERE val != '(3.0,4.0)' ORDER BY id;

# Test less than
SELECT id FROM t1 WHERE val < '(3.0,4.0)' ORDER BY id;
SELECT id FROM t1 WHERE val < '(0.0,0.0)' ORDER BY id;

# Test greater than
SELECT id FROM t1 WHERE val > '(1.0,2.0)' ORDER BY id;
SELECT id FROM t1 WHERE val > '(0.0,0.0)' ORDER BY id;

# Test less than or equal
SELECT id FROM t1 WHERE val <= '(3.0,4.0)' ORDER BY id;

# Test greater than or equal
SELECT id FROM t1 WHERE val >= '(3.0,4.0)' ORDER BY id;

# Test BETWEEN
SELECT id FROM t1 WHERE val BETWEEN '(0.0,0.0)' AND '(3.0,5.0)' ORDER BY id;

# Test with same real part, different imaginary
SELECT id FROM t1 WHERE val > '(3.0,0.0)' ORDER BY id;
SELECT id FROM t1 WHERE val < '(3.0,5.0)' ORDER BY id;

# Test NULL
INSERT INTO t1 VALUES (13, NULL);
SELECT id FROM t1 WHERE val IS NULL;
SELECT id FROM t1 WHERE val IS NOT NULL ORDER BY id;
SELECT id FROM t1 WHERE val = NULL;

DROP TABLE t1;

--source include/villagesql/uninstall_complex_extension.inc
