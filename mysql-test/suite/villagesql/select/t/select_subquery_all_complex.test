# Test Subquery with ALL quantifier for COMPLEX type
# Grammar: SELECT ... WHERE expr op ALL (SELECT ...)

--source include/villagesql/not_implemented_complex_type.inc

--source include/villagesql/install_complex_extension.inc

CREATE TABLE t1 (id INT PRIMARY KEY, val COMPLEX);
INSERT INTO t1 VALUES (1, '(1.0,2.0)'), (2, '(3.0,4.0)'), (3, '(5.0,6.0)');

CREATE TABLE t2 (val COMPLEX);
INSERT INTO t2 VALUES ('(1.0,2.0)'), ('(2.0,3.0)');

# > ALL comparison (requires comparison logic to be implemented)
SELECT * FROM t1 WHERE val > ALL (SELECT val FROM t2);

# = ALL comparison (only true if all are equal, or subquery empty)
SELECT * FROM t1 WHERE val = ALL (SELECT val FROM t2 WHERE val = '(9.0,9.0)');

DROP TABLE t1;
DROP TABLE t2;

--source include/villagesql/uninstall_complex_extension.inc
