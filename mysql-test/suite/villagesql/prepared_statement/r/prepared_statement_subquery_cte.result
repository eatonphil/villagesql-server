CREATE TABLE t1 (
id INT PRIMARY KEY,
name VARCHAR(50),
val COMPLEX
);
INSERT INTO t1 VALUES (1, 'Alice', '(1.0,2.0)');
INSERT INTO t1 VALUES (2, 'Bob', '(3.0,4.0)');
PREPARE stmt1 FROM 'SELECT id FROM (SELECT id, name FROM t1) AS sub WHERE id = 1';
EXECUTE stmt1;
id
1
DEALLOCATE PREPARE stmt1;
# Test 2: Subquery selecting custom column
PREPARE stmt2 FROM 'SELECT id FROM (SELECT id, val FROM t1) AS sub WHERE id = 1';
ERROR HY000: Custom types are not yet supported in prepared statements
# Test 3: Subquery with custom column in WHERE
PREPARE stmt3 FROM 'SELECT id FROM (SELECT * FROM t1 WHERE val = ?) AS sub';
ERROR HY000: Custom types are not yet supported in prepared statements
PREPARE stmt4 FROM 'WITH cte AS (SELECT id, name FROM t1) SELECT id FROM cte';
EXECUTE stmt4;
id
1
2
DEALLOCATE PREPARE stmt4;
# Test 5: CTE selecting custom column
PREPARE stmt5 FROM 'WITH cte AS (SELECT id, val FROM t1) SELECT id FROM cte';
ERROR HY000: Custom types are not yet supported in prepared statements
# Test 6: CTE with custom column in WHERE
PREPARE stmt6 FROM 'WITH cte AS (SELECT * FROM t1 WHERE val = ?) SELECT id FROM cte';
ERROR HY000: Custom types are not yet supported in prepared statements
DROP TABLE t1;
