# Test COMPLEX_DIVIDE division by zero returns NULL
SELECT vsql_complex.COMPLEX_DIVIDE('(1.0,2.0)', '(0.0,0.0)') AS result;
result
NULL
Warnings:
Warning	3200	VDF error in function 'complex_divide': division by 0
SELECT vsql_complex.COMPLEX_DIVIDE('(3.0,4.0)', '(0,0)') AS result;
result
NULL
Warnings:
Warning	3200	VDF error in function 'complex_divide': division by 0
# Verify non-zero division still works
SELECT vsql_complex.COMPLEX_DIVIDE('(4.0,2.0)', '(2.0,0.0)') AS result;
result
(2,1)
# Test with table data
CREATE TABLE t1 (
id INT PRIMARY KEY,
numerator COMPLEX,
denominator COMPLEX
);
INSERT INTO t1 VALUES (1, '(1.0,2.0)', '(0.0,0.0)');
INSERT INTO t1 VALUES (2, '(3.0,4.0)', '(1.0,1.0)');
INSERT INTO t1 VALUES (3, '(5.0,0.0)', '(0,0)');
SELECT id, numerator, denominator, vsql_complex.COMPLEX_DIVIDE(numerator, denominator) AS quotient FROM t1;
id	numerator	denominator	quotient
1	(1,2)	(0,0)	NULL
2	(3,4)	(1,1)	(3.5,0.5)
3	(5,0)	(0,0)	NULL
Warnings:
Warning	3200	VDF error in function 'complex_divide': division by 0
Warning	3200	VDF error in function 'complex_divide': division by 0
DROP TABLE t1;
