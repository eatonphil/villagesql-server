# Test self-join with same-type COMPLEX comparison

--source include/villagesql/install_complex_extension.inc

CREATE TABLE t_complex (id INT PRIMARY KEY, val COMPLEX);

INSERT INTO t_complex VALUES
  (1, '(0,0)'),
  (2, '(-0,0)'),
  (3, '(-0,-0)'),
  (4, '(0,-0)'),
  (5, '(-1.0,-4.0)'),
  (6, '(1.0,4.0)'),
  (7, '(-1.0,4.0)'),
  (8, '(1.0,-4.0)'),
  (9, '(-0.01,7.0)'),
  (10, '(0.01,-7.0)'),
  (11, '(1,2)');

SELECT c1.id as id1, c2.id as id2, c1.val as val1, c2.val as val2
FROM t_complex c1
JOIN t_complex c2 ON c1.val = c2.val
ORDER BY c1.id, c2.id, c1.val, c2.val;

SELECT c1.id as id1, c2.id as id2, c1.val as val1, c2.val as val2
FROM t_complex c1
JOIN t_complex c2 ON c1.val = c2.val
ORDER BY c1.val, c2.val, c1.id, c2.id;

DROP TABLE t_complex;

--source include/villagesql/uninstall_complex_extension.inc
