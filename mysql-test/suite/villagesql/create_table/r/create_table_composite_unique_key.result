CREATE TABLE composite_uk_table (
id INT PRIMARY KEY AUTO_INCREMENT,
sensor_type VARCHAR(50),
location_id INT,
complex_reading COMPLEX,
UNIQUE KEY uk_sensor_location (sensor_type, location_id, complex_reading)
);
SHOW COLUMNS FROM composite_uk_table;
Field	Type	Null	Key	Default	Extra
id	int	NO	PRI	NULL	auto_increment
sensor_type	varchar(50)	YES	MUL	NULL	
location_id	int	YES		NULL	
complex_reading	vsql_complex.COMPLEX	YES		NULL	
INSERT INTO composite_uk_table (sensor_type, location_id, complex_reading)
VALUES ('temperature', 1, '(45.0,46.0)');
INSERT INTO composite_uk_table (sensor_type, location_id, complex_reading)
VALUES ('pressure', 1, '(47.0,48.0)');
INSERT INTO composite_uk_table (sensor_type, location_id, complex_reading)
VALUES ('temperature', 2, '(49.0,50.0)');
INSERT INTO composite_uk_table (sensor_type, location_id, complex_reading)
VALUES ('temperature', 1, '(51.0,52.0)');
SELECT * FROM composite_uk_table ORDER BY id;
id	sensor_type	location_id	complex_reading
1	temperature	1	(45,46)
2	pressure	1	(47,48)
3	temperature	2	(49,50)
4	temperature	1	(51,52)
INSERT INTO composite_uk_table (sensor_type, location_id, complex_reading)
VALUES ('temperature', 1, '(51.0,52.0)');
ERROR 23000: Duplicate entry 'temperature-1-(51,52)' for key 'composite_uk_table.uk_sensor_location'
SELECT * FROM composite_uk_table ORDER BY id;
id	sensor_type	location_id	complex_reading
1	temperature	1	(45,46)
2	pressure	1	(47,48)
3	temperature	2	(49,50)
4	temperature	1	(51,52)
DROP TABLE composite_uk_table;
include/rpl/deprecated/show_binlog_events.inc
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
#	#	Query	#	#	use `test`; CREATE TABLE `composite_uk_table` (
  `id` int NOT NULL AUTO_INCREMENT,
  `sensor_type` varchar(50) DEFAULT NULL,
  `location_id` int DEFAULT NULL,
  `complex_reading` vsql_complex.COMPLEX DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_sensor_location` (`sensor_type`,`location_id`,`complex_reading`)
)
#	#	Query	#	#	BEGIN
#	#	Table_map	#	#	table_id: # (test.composite_uk_table)
#	#	Write_rows	#	#	table_id: # flags: STMT_END_F
#	#	Xid	#	#	COMMIT /* XID */
#	#	Query	#	#	BEGIN
#	#	Table_map	#	#	table_id: # (test.composite_uk_table)
#	#	Write_rows	#	#	table_id: # flags: STMT_END_F
#	#	Xid	#	#	COMMIT /* XID */
#	#	Query	#	#	BEGIN
#	#	Table_map	#	#	table_id: # (test.composite_uk_table)
#	#	Write_rows	#	#	table_id: # flags: STMT_END_F
#	#	Xid	#	#	COMMIT /* XID */
#	#	Query	#	#	BEGIN
#	#	Table_map	#	#	table_id: # (test.composite_uk_table)
#	#	Write_rows	#	#	table_id: # flags: STMT_END_F
#	#	Xid	#	#	COMMIT /* XID */
#	#	Query	#	#	use `test`; DROP TABLE `composite_uk_table` /* generated by server */
