CREATE TABLE devices (
device_id INT PRIMARY KEY,
device_name VARCHAR(50)
);
CREATE TABLE locations (
location_id INT PRIMARY KEY,
location_name VARCHAR(50)
);
CREATE TABLE complex_names (
complex_value COMPLEX PRIMARY KEY,
name VARCHAR(50)
);
SHOW COLUMNS FROM complex_names;
Field	Type	Null	Key	Default	Extra
complex_value	vsql_complex.COMPLEX	NO	PRI	NULL	
name	varchar(50)	YES		NULL	
INSERT INTO devices VALUES (1, 'sensor_alpha'), (2, 'sensor_beta');
INSERT INTO locations VALUES (1, 'room_101'), (2, 'room_102');
INSERT INTO complex_names VALUES ('(0,0)', 'zero'), ('(1,0)', 'one'), ('(0,1)', 'i');
CREATE TABLE measurements (
measurement_id INT PRIMARY KEY,
device_id INT,
location_id INT,
complex_reading COMPLEX,
string_val VARCHAR(50),
FOREIGN KEY fk_device (device_id) REFERENCES devices(device_id),
FOREIGN KEY fk_location (location_id) REFERENCES locations(location_id),
FOREIGN KEY fk_names (complex_reading) REFERENCES complex_names(complex_value)
);
SHOW COLUMNS FROM measurements;
Field	Type	Null	Key	Default	Extra
measurement_id	int	NO	PRI	NULL	
device_id	int	YES	MUL	NULL	
location_id	int	YES	MUL	NULL	
complex_reading	vsql_complex.COMPLEX	YES	MUL	NULL	
string_val	varchar(50)	YES		NULL	
INSERT INTO measurements VALUES (1, 1, 1, '(0.0,0.0)', 'foo');
INSERT INTO measurements VALUES (2, 2, 2, '(0,1)', 'bar');
SELECT * FROM measurements;
measurement_id	device_id	location_id	complex_reading	string_val
1	1	1	(0,0)	foo
2	2	2	(0,1)	bar
INSERT INTO measurements VALUES (3, 999, 1, '(107.0,108.0)', 'foo');
ERROR 23000: Cannot add or update a child row: a foreign key constraint fails (`test`.`measurements`, CONSTRAINT `measurements_ibfk_1` FOREIGN KEY (`device_id`) REFERENCES `devices` (`device_id`))
INSERT INTO measurements VALUES (4, 1, 999, '(109.0,110.0)', 'foo');
ERROR 23000: Cannot add or update a child row: a foreign key constraint fails (`test`.`measurements`, CONSTRAINT `measurements_ibfk_2` FOREIGN KEY (`location_id`) REFERENCES `locations` (`location_id`))
INSERT INTO measurements VALUES (5, 2, 2, '(0,-1)', 'foo');
ERROR 23000: Cannot add or update a child row: a foreign key constraint fails (`test`.`measurements`, CONSTRAINT `measurements_ibfk_3` FOREIGN KEY (`complex_reading`) REFERENCES `complex_names` (`complex_value`))
SELECT * FROM measurements;
measurement_id	device_id	location_id	complex_reading	string_val
1	1	1	(0,0)	foo
2	2	2	(0,1)	bar
DROP TABLE measurements;
DROP TABLE complex_names;
DROP TABLE devices;
DROP TABLE locations;
include/rpl/deprecated/show_binlog_events.inc
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
#	#	Query	#	#	use `test`; CREATE TABLE devices (
device_id INT PRIMARY KEY,
device_name VARCHAR(50)
)
#	#	Query	#	#	use `test`; CREATE TABLE locations (
location_id INT PRIMARY KEY,
location_name VARCHAR(50)
)
#	#	Query	#	#	use `test`; CREATE TABLE `complex_names` (
  `complex_value` vsql_complex.COMPLEX NOT NULL,
  `name` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`complex_value`)
)
#	#	Query	#	#	BEGIN
#	#	Table_map	#	#	table_id: # (test.devices)
#	#	Write_rows	#	#	table_id: # flags: STMT_END_F
#	#	Xid	#	#	COMMIT /* XID */
#	#	Query	#	#	BEGIN
#	#	Table_map	#	#	table_id: # (test.locations)
#	#	Write_rows	#	#	table_id: # flags: STMT_END_F
#	#	Xid	#	#	COMMIT /* XID */
#	#	Query	#	#	BEGIN
#	#	Table_map	#	#	table_id: # (test.complex_names)
#	#	Write_rows	#	#	table_id: # flags: STMT_END_F
#	#	Xid	#	#	COMMIT /* XID */
#	#	Query	#	#	use `test`; CREATE TABLE `measurements` (
  `measurement_id` int NOT NULL,
  `device_id` int DEFAULT NULL,
  `location_id` int DEFAULT NULL,
  `complex_reading` vsql_complex.COMPLEX DEFAULT NULL,
  `string_val` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`measurement_id`),
  KEY `fk_device` (`device_id`),
  KEY `fk_location` (`location_id`),
  KEY `fk_names` (`complex_reading`),
  CONSTRAINT `measurements_ibfk_1` FOREIGN KEY (`device_id`) REFERENCES `devices` (`device_id`),
  CONSTRAINT `measurements_ibfk_2` FOREIGN KEY (`location_id`) REFERENCES `locations` (`location_id`),
  CONSTRAINT `measurements_ibfk_3` FOREIGN KEY (`complex_reading`) REFERENCES `complex_names` (`complex_value`)
)
#	#	Query	#	#	BEGIN
#	#	Table_map	#	#	table_id: # (test.measurements)
#	#	Write_rows	#	#	table_id: # flags: STMT_END_F
#	#	Xid	#	#	COMMIT /* XID */
#	#	Query	#	#	BEGIN
#	#	Table_map	#	#	table_id: # (test.measurements)
#	#	Write_rows	#	#	table_id: # flags: STMT_END_F
#	#	Xid	#	#	COMMIT /* XID */
#	#	Query	#	#	use `test`; DROP TABLE `measurements` /* generated by server */
#	#	Query	#	#	use `test`; DROP TABLE `complex_names` /* generated by server */
#	#	Query	#	#	use `test`; DROP TABLE `devices` /* generated by server */
#	#	Query	#	#	use `test`; DROP TABLE `locations` /* generated by server */
