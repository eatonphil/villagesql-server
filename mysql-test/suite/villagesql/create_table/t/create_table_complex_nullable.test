# Test CREATE TABLE with COMPLEX NULL/NOT NULL constraints
# Tests NULL and NOT NULL constraints on COMPLEX columns

--source include/villagesql/install_complex_extension.inc
--source include/villagesql/binlog_check_begin.inc

CREATE TABLE t1 (
    id INT PRIMARY KEY,
    required_complex COMPLEX NOT NULL,
    optional_complex COMPLEX NULL
);

SHOW COLUMNS FROM t1;

INSERT INTO t1 VALUES (1, '(1.0,2.0)', '(3.0,4.0)');
INSERT INTO t1 VALUES (2, '(5.0,6.0)', NULL);

SELECT * FROM t1;

# Test that NULL cannot be inserted into NOT NULL COMPLEX column
--error ER_BAD_NULL_ERROR
INSERT INTO t1 VALUES (3, NULL, '(7.0,8.0)');

SELECT * FROM t1;

DROP TABLE t1;

--source include/villagesql/binlog_check_end.inc
--source include/villagesql/uninstall_complex_extension.inc
